<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vulnerability Report</title>
</head>
<body>
    <h1>Vulnerability Report</h1>

    {% for product_name, vulnerabilities in vulnerabilities_by_product.items() %}
        <h3>{{ product_name }}</h3>
        <ul>
            {% for vulnerability in vulnerabilities %}
                <li>
                    CVE ID: <a href="{{ vulnerability.cve_url }}" target="_blank">{{ vulnerability.cve_id }}</a>
                </li>
            {% endfor %}
        </ul>
    {% endfor %}

    <h1>Open Ports Vulnerabilities</h1>

    <table border="1">
        <tr>
            <th>Port Number</th>
            <th>Protocol</th>
            <th>Vulnerabilities</th>
        </tr>
        {% for result in open_ports_vulnerabilities %}
            <tr>
                <td>{{ result.port_number }}</td>
                <td>{{ result.protocol }}</td>
                <td>{{ result.vulnerabilities }}</td>
            </tr>
        {% endfor %}
    </table>

    <h1>Searchsploit Results</h1>
    
    {% for result in searchsploit_results %}
        <div>
            <h3>Service Info: {{ result.service_info }}</h3>
            <pre>Searchsploit Result: {{ result.searchsploit_output }}</pre>
        </div>
    {% endfor %}
</body>
</html>
